# NextAuth (обязательно в production)
NEXTAUTH_SECRET=generate-with-openssl-rand-base64-32
NEXTAUTH_URL=http://localhost:3000
# ALLOW_DEV_FALLBACK_SECRET=1  # только для локальной отладки без .env.local

# Первый пользователь создаётся через: npm run seed:admin

# Workspace (обязательно в production — не использовать дефолт из кода)
WORKSPACE_ROOT=/path/to/your/data

# Evidence ledger (optional — S3/GCS bucket for ledger-entry.json)
# LEDGER_BUCKET=my-audit-ledger-bucket
# AWS_REGION=us-east-1  # for CI publish

# Issue ack server (optional — server-side acknowledgements for anchoring issues)
# ACK_SERVER_URL=http://localhost:8787
# ACK_API_KEY=optional-shared-secret

# Auditor portal API (optional — read-only portal over S3 ledger/rollups)
# LEDGER_BUCKET=your-ledger-bucket  # required for portal
# LEDGER_PREFIX=ledger
# DOC_LEDGER_PREFIX=doc-ledger   # doc_update + config_change (allowlist); included in daily rollup Merkle root
# DOC_LEDGER_PENDING_PREFIX=doc-ledger/_pending   # optional; default ${DOC_LEDGER_PREFIX}/_pending
# REQUIRE_CONFIG_LEDGER=1        # if 1/true/yes: POST allowlist fails when doc-ledger write fails (audit trail hard requirement)
# PENDING_GC_OLDER_THAN_HOURS=24  # for ledger:pending:gc (stale _pending cleanup)
# PENDING_GC_MAX_DELETE=1000      # safety: max objects to delete per run
# PENDING_GC_MAX_BYTES=262144000   # safety: max total bytes to delete per run (250MB)
# PENDING_GC_REQUIRE_CONFIRM=1     # require CONFIRM=DELETE or --confirm DELETE
# Health alert (scripts/health-alert.mjs + workflow)
# HEALTH_ALERT_ENABLED=1   # repo var to enable workflow
# ALERT_ROLLUP_MAX_AGE_HOURS=24   # alert if no rollup in N hours
# ALERT_PENDING_THRESHOLD=10     # alert if pending count > N
# SLACK_WEBHOOK_URL=...   # for --slack (optional)
# MAIL_LEDGER_PREFIX=mail-ledger   # included in daily rollup Merkle root
# MAIL_DECISIONS_PREFIX=mail-decisions  # operator decision records (Portal API)
# LEDGER_ROLLUP_PREFIX=ledger-rollups
# PORTAL_AUTH_MODE=none|api_key|oidc
# PORTAL_API_KEY=...  # when api_key mode
# PORTAL_WRITE_API_KEY=...  # for docs propose/approve (MVP: can equal PORTAL_API_KEY)
# PORTAL_OIDC_JWKS_URL=... PORTAL_OIDC_ISSUER=... PORTAL_OIDC_AUDIENCE=...  # when oidc mode
# ACK_SERVER_URL=... ACK_API_KEY=...  # optional ack proxy
# PORT=8790

# Document Store (Portal storage — docs-store, mail-proposals, mail-events)
# DOCS_BUCKET=my-docs
# DOCS_PREFIX=docs-store
# DOCS_PROPOSALS_PREFIX=mail-proposals
# MAIL_EVENTS_PREFIX=mail-events
# MAIL_LEDGER_PREFIX=mail-ledger

# Main app: proxy to Portal API for docs (optional)
# PORTAL_API_URL=http://localhost:8790
# PORTAL_API_KEY=...

# Mail collector (Gmail + IMAP)
# MAIL_GMAIL_ENABLED=1
# MAIL_GMAIL_PROJECT_ID=... MAIL_GMAIL_CLIENT_EMAIL=... MAIL_GMAIL_PRIVATE_KEY=...
# MAIL_GMAIL_IMPERSONATE=user@domain  # Workspace domain-wide delegation
# MAIL_GMAIL_LABELS=Migration/Inbound,Finance,Mura
# MAIL_IMAP_ENABLED=1
# MAIL_IMAP_HOST=mail.nic.ru MAIL_IMAP_PORT=993 MAIL_IMAP_USER=... MAIL_IMAP_PASSWORD=...
# MAIL_IMAP_FOLDERS=INBOX
# MAIL_EVENTS_BUCKET=...  # or MAIL_BUCKET / DOCS_BUCKET
# LEDGER_BACKEND=s3|gcs

# Mail allowlist (M2): env override
# MAIL_ALLOWED_FROM=pay@bank.ru,billing@vendor.com
# MAIL_ALLOWED_FROM_REGEX=@(bank\.ru|vendor\.com)$
# MAIL_ALLOWED_FROM_MODE=deny_all   # deny_all | allow_all

# Mail allowlist from docs-store (M2.1); collector reads this if env not set
# MAIL_ALLOWLIST_DOC_ID=config/mail-allowlist
