# Infra decision: Railway vs ECS (без оверинжиниринга)

## 3.1. Решение по "триггерам" (gating)

Переход на ECS имеет смысл, если выполняется **2 из 3**:

### 1. Надёжность/контроль

* мульти-регион / строгий networking / private subnets / VPC peering
* сложные SLO и кастомные deployment стратегии

### 2. Compliance

* требования: собственные ключи, KMS, VPC-изоляция, аудит инфраструктуры, SOC2/ISO
* формальные требования на "cloud account ownership"

### 3. Стоимость/нагрузка

* устойчиво высокая нагрузка
* выгоднее reserved/spot/гранулярная настройка ресурсов

**Если меньше 2 из 3** — оставайся на Railway: быстрее и дешевле по операционным затратам.

---

## 3.2. Что делать "прямо сейчас" (на Railway)

Чтобы Stage-2 был лёгким:

* миграции как **one-off** (уже описано для ECS)
* воркер отдельным сервисом ✅
* секреты только через env (никаких файлов)
* избегать локального диска для файлов (S3/Storage) — главный блокер масштабирования

---

## 3.3. Минимальный план принятия решения (через 30 дней)

Собери метрики за месяц:

* аптайм (uptime)
* количество rollback
* среднее время восстановления
* стоимость
* spikes по auth errors / 5xx

**Если всё спокойно** — Railway остаётся.  
**Если нет** — запускаешь `STAGE2_MIGRATION_PLAN.md`.
